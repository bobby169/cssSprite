/*!
 * DATE: 2018-01-25
 * @author: bobby169
 * 115393304
 * (c) bobby169
 */
!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.CssSprite=b()}(this,function(){"use strict";function a(a){var c,d,e,f,g,h,i,j,k,l,m,b=this;if(this.options=Object.assign({target:"body",images:null,frames:{},animations:null,fps:30,paused:!1,frameIndex:0,loop:-1,change:!1,animationend:!1},a),c=function(a){return!(!a||1!==a.nodeType)},d=function(a){return"function"==typeof a||!(!a||"object"!=typeof a)},this.target=c(this.options.target)?this.options.target:document.querySelector(this.options.target),this.renderType="backgroundPosition",this._frameIndex=this.options.frameIndex,this._frameWidth=0,this._frameHeight=0,this._frames=[],this._spacing=0,this._margin=0,this._loopIndex=0,this.currentFrame=0,this.options.frames||(this.options.frames=Object.create(null)),0===this.options.loop&&(this.options.paused=!0),this.options.frames.width&&(this.target.style.width=this.options.frames.width+"px"),this.options.frames.height&&(this.target.style.height=this.options.frames.height+"px"),d(this.options.frames)&&!this.options.frames.width&&(this.options.frames.width=this.target.clientWidth),d(this.options.frames)&&!this.options.frames.height&&(this.options.frames.height=this.target.clientHeight),Array.isArray(this.options.images)&&this.options.images.length)this.totalFrames=this.options.images.length,this.options.images.forEach(function(a,c){a.tagName&&"IMG"===a.tagName?(0!==c&&(a.style.display="none"),b.target.appendChild(a),b.renderType="img"):b.renderType="backgroundImage"}),b.options.paused||b._tick();else if(Array.isArray(this.options.frames)&&this.options.frames.length){for(this.totalFrames=this.options.frames.length,e=0;e<this.totalFrames;e++)f=this.options.frames[e][0],g=this.options.frames[e][1],h=this.options.frames[e][2]?this.options.frames[e][2]:this.target.clientWidth,i=this.options.frames[e][3]?this.options.frames[e][3]:this.target.clientHeight,this._frames.push({x:f,y:g,width:h,height:i});b.options.paused||b._tick()}else null!==this.options.frames.width&&null!==this.options.frames.height?(this._frameWidth=this.options.frames.width,this._frameHeight=this.options.frames.height,this._spacing=this.options.spacing||0,this._margin=this.options.margin||0,this.totalFrames=this.options.frames.count,j=0,h=this._frameWidth,i=this._frameHeight,k=this._spacing,l=this._margin,m=this.totalFrames,this._loadImage(function(a,c){for(var g,d=a,e=c,f=l;e-l-i>=f;){for(g=l;d-l-h>=g&&!(j>=m);)j++,b._frames.push({x:g,y:f,width:h,height:i}),g+=h+k;f+=i+k}void 0===b.totalFrames&&(b.totalFrames=j),b.options.paused||b._tick()})):b.options.paused||b._tick()}Object.assign(a.prototype,{_getCss:function(a,b){var c=function(a){return a.replace(/-+(.)?/g,function(a,b){return b?b.toUpperCase():""})};return a.style[c(b)]||getComputedStyle(a,"").getPropertyValue(b)},_loadImage:function(a){var b,c;"string"==typeof this.options.images?(b=this.options.images,this.target.style.backgroundImage="url("+b+")"):b=this._getCss(this.target,"background-image").replace(/url\((['"])?(.*?)\1\)/gi,"$2"),c=new Image,c.onload=function(){var b=c.width,d=c.height;a(b,d)},c.src=b},_getFrameIndex:function(){return this._frameIndex},_setFrameIndex:function(a){var b=this.options.animations?this.currentAnimation.length:this.totalFrames;a=a>b-1?0:a,a=0>a?b-1:a,this._frameIndex=a},_animation:function(){var b,a=function(a,b){return a++,a>=b?this.currentAnimation&&this.currentAnimation.next?(a=0,this.currentAnimation=this.options.animations[this.currentAnimation.next],this._tick()):-1===this.options.loop?(a=0,this._tick()):this.options.loop>0&&this._loopIndex<this.options.loop-1?(a=0,this._loopIndex++,this._tick()):"function"==typeof this.options.animationend&&this.options.animationend.call(this):this._tick(),a};if(this.options.animations){if(void 0===this.currentAnimation)for(b in this.options.animations){this.currentAnimation=this.options.animations[b];break}Array.isArray(this.currentAnimation)?(this.frame(this.currentAnimation[this._frameIndex]),this._frameIndex=a.call(this,this._frameIndex,this.currentAnimation.length)):this.currentAnimation.frames&&this.currentAnimation.frames.length&&(this.frame(this.currentAnimation.frames[this._frameIndex]),this._frameIndex=a.call(this,this._frameIndex,this.currentAnimation.frames.length))}else this.frame(this._frameIndex),this._frameIndex=a.call(this,this._frameIndex,this.totalFrames)},_tick:function(){var a=this,b=1e3/this.options.fps;this.currentAnimation&&this.currentAnimation.speed&&(b/=this.currentAnimation.speed),void 0!==this.options.duration&&(b=this.options.duration/this.totalFrames),this._interval&&clearTimeout(this._interval),this._interval=setTimeout(function(){a._animation()},b)},_goto:function(a){this.stop(),this._loopIndex=0,"string"==typeof a?(this.options.animations[a]!==this.currentAnimation&&(this._frameIndex=0,this.currentAnimation=this.options.animations[a],this.currentAnimationName=a),this._tick()):"number"==typeof a?(this._frameIndex=a,this._tick()):void 0===a&&(this._frameIndex=0,this._tick())},frame:function(a){var b=this.target;("undefined"==typeof a||isNaN(a))&&(a=this.currentFrame),"backgroundImage"===this.renderType?b.style.backgroundImage=this.options.images[a].img?"url("+this.options.images[a].img+")":"url("+this.options.images[a]+")":"img"===this.renderType?this.options.images.forEach(function(b,c){b.style.display=c===a?"inline-block":"none"}):(b.style.backgroundPosition=-this._frames[a].x+"px "+-this._frames[a].y+"px",b.style.width=this._frames[a].width+"px",b.style.height=this._frames[a].height+"px"),this.currentFrame=a,"function"==typeof this.options.change&&this.options.change.apply(this,[a,this._frameIndex])},gotoAndPlay:function(a){this._goto(a)},gotoAndStop:function(a){this.stop(),"undefined"==typeof a&&(a=this._frameIndex),"string"==typeof a?(this._frameIndex=0,this.currentAnimation=this.options.animations[a],this.currentAnimationName=a,this.frame(this.currentAnimation[this._frameIndex])):this.options.animations?this.frame(this.currentAnimation[a]):(this._frameIndex=a,this.frame(this._frameIndex))},play:function(a){this._goto(a)},stop:function(){clearTimeout(this._interval)},fps:function(a){this.options.fps=a}});try{Object.defineProperties(a.prototype,{frameIndex:{set:a.prototype._setFrameIndex,get:a.prototype._getFrameIndex}})}catch(b){}return a.createAnimations=function(a,b){for(var c=[];b-a>=0;)c.push(a),a++;return c},a});